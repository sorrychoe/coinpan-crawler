<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>coinpan-dashboard</title>
    <script src="https://cdn.anychart.com/releases/v8/js/anychart-base.min.js"></script>
    <script src="https://cdn.anychart.com/releases/v8/js/anychart-tag-cloud.min.js"></script>
    <script src="https://cdn.anychart.com/releases/v8/js/anychart-ui.min.js"></script>
    <script src="https://cdn.anychart.com/releases/v8/js/anychart-exports.min.js"></script>
    <link href="https://cdn.anychart.com/releases/v8/css/anychart-ui.min.css" type="text/css" rel="stylesheet">
    <link href="https://cdn.anychart.com/releases/v8/fonts/css/anychart-font.min.css" type="text/css" rel="stylesheet">
    <style>
        body {
            font-family: Arial, sans-serif;
            background-color: #f5f5f5;
            margin: 0;
            padding: 0;
        }
        .dashboard {
            display: flex;
            justify-content: space-between;
            margin: 20px;
            background-color: white;
            border-radius: 5px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.2);
        }
        .chart-container {
            width: 48%;
            padding: 20px;
        }
        #bar-chart {
            height: 400px;
        }
        #word-cloud {
            text-align: center;
            padding: 20px;
        }
    </style>
</head>
<body>
    <div class="dashboard">
        <div class="chart-container">
            <h2>게시글 작성자 순위</h2>
            <div id="bar-chart">
            </div>
        </div>
        <div class="chart-container">
            <h2>주요 등장 단어</h2>
            <div id="word-cloud" style="width:100%; height:70%;">
            </div>
        </div>
        <script>
            fetch('http://localhost:8000/names')
            .then(response => response.json())
            .then(data =>{
            anychart.onDocumentReady(function() {
                anychart.theme('darkBlue');
                let names = [];
                for (let k in data["name"]){
                    let b = {};
                    if (data["frequent"][k]>=2){
                        b["x"] = data["name"][k];
                        b["value"]  = data["frequent"][k];
                        names.push(b);
                    }};
                names.sort(function (First, Second) {
                    return Second["value"] - First["value"];
                });
                var chart = anychart.bar();
                chart.animation(true);
                chart.padding([10, 40, 5, 20]);
                var series = chart.bar(names);
                series
                    .tooltip()
                    .position('right')
                    .anchor('left-center')
                    .offsetX(5)
                    .offsetY(0)

                chart.container("bar-chart");
                chart.draw();
            })});
    </script>
        <script>
            fetch('http://localhost:8000/words')
            .then(response => response.json())
            .then(data =>{
            anychart.onDocumentReady(function() {
                let words = [];
                for (let i in data["words"]){
                    let a = {};
                    data["frequent"][i] *= 10000000;
                    a["x"] = data["words"][i];
                    a["value"]  = data["frequent"][i];
                    words.push(a);
                    };
                var chart = anychart.tagCloud(words);
                chart.angles([0]);
                chart.container("word-cloud");
                chart.draw();
            })});
    </script>
    </div>
</html>
