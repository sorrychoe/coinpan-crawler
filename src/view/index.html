<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>coinpan-dashboard</title>
    <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
    <script src="https://cdn.anychart.com/releases/v8/js/anychart-base.min.js"></script>
    <script src="https://cdn.anychart.com/releases/v8/js/anychart-tag-cloud.min.js"></script>
    <style>
        body {
            font-family: Arial, sans-serif;
            background-color: #f5f5f5;
            margin: 0;
            padding: 0;
        }
        .dashboard {
            display: flex;
            justify-content: space-between;
            margin: 20px;
            background-color: white;
            border-radius: 5px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.2);
        }
        .chart-container {
            width: 48%;
            padding: 20px;
        }
        #bar-chart {
            height: 400px;
        }
        #word-cloud {
            text-align: center;
            padding: 20px;
        }
    </style>
</head>
<body>
    <div class="dashboard">
        <div class="chart-container">
            <h2>게시글 작성자 순위</h2>
            <div id="bar-chart">
            </div>
        </div>
        <div class="chart-container">
            <h2>주요 등장 단어</h2>
            <div id="word-cloud" style="width:100%; height:70%;">
            </div>
        </div>
        <script>
            fetch('http://localhost:8000/names')
            .then(response => response.json())
            .then(data => {
                var trace = {
                type: 'bar',
                x: Object.values(data["name"]),
                y: Object.values(data["frequent"]),
                marker: {
                    color: 'rgba(75, 192, 192, 0.6)',
                    line: {
                    color: 'rgba(75, 192, 192, 1)',
                    width: 1
                    }
                }
                };

                var layout = {
                xaxis: {
                    title: '이름'
                },
                yaxis: {
                    title: '빈도',
                    rangemode: 'tozero'
                }
                };
                Plotly.newPlot('bar-chart', [trace], layout);
            });
        </script>
        <script>
            fetch('http://localhost:8000/words')
            .then(response => response.json())
            .then(data =>{
            anychart.onDocumentReady(function () {
                let words = [];
                for (let i in data["words"]){
                    let a = {};
                    data["frequent"][i] *= 10000000;
                    a["x"] = data["words"][i];
                    a["value"]  = data["frequent"][i];
                    words.push(a);
                    };
                var chart = anychart.tagCloud(words);
                chart.angles([0]);
                chart.container("word-cloud");
                chart.draw();
            })});
    </script>
    </div>
</html>
